\hypertarget{classdml_1_1mcml_1_1MCML}{}\section{dml.\+mcml.\+M\+C\+ML Class Reference}
\label{classdml_1_1mcml_1_1MCML}\index{dml.\+mcml.\+M\+C\+ML@{dml.\+mcml.\+M\+C\+ML}}


Inheritance diagram for dml.\+mcml.\+M\+C\+ML\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=172pt]{classdml_1_1mcml_1_1MCML__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for dml.\+mcml.\+M\+C\+ML\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=172pt]{classdml_1_1mcml_1_1MCML__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+dims=None, learning\+\_\+rate=\char`\"{}adaptive\char`\"{}, eta0=0.\+01, initial\+\_\+metric=None, max\+\_\+iter=20, prec=0.\+01, tol=0.\+01, descent\+\_\+method=\char`\"{}S\+DP\char`\"{}, eta\+\_\+thres=1e-\/14, learn\+\_\+inc=1.\+01, learn\+\_\+dec=0.\+5)\hypertarget{classdml_1_1mcml_1_1MCML_ab24bfae43298806c065030a453dd6613}{}\label{classdml_1_1mcml_1_1MCML_ab24bfae43298806c065030a453dd6613}

\item 
def \hyperlink{classdml_1_1mcml_1_1MCML_a73bb7173d9688126b49e585ff4434892}{metadata} (self)
\item 
def \hyperlink{classdml_1_1mcml_1_1MCML_ad1980c9bf7c3b8843d36f8f1666e08a6}{metric} (self)
\item 
def \hyperlink{classdml_1_1mcml_1_1MCML_a0984330dd64aad712a46dcc3ba27baa8}{fit} (self, X, y)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries num\+\_\+dims\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_adbb2311297903823e3af1c35086adb03}{}\label{classdml_1_1mcml_1_1MCML_adbb2311297903823e3af1c35086adb03}

\item 
{\bfseries initial\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ac05cdbdf44871053938723291e3bbee6}{}\label{classdml_1_1mcml_1_1MCML_ac05cdbdf44871053938723291e3bbee6}

\item 
{\bfseries max\+\_\+it\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ad952bdb80b531882c6b591761aa65543}{}\label{classdml_1_1mcml_1_1MCML_ad952bdb80b531882c6b591761aa65543}

\item 
{\bfseries eta\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_aa2faa2f85ba20baae9fdcfdcb1b0fdaa}{}\label{classdml_1_1mcml_1_1MCML_aa2faa2f85ba20baae9fdcfdcb1b0fdaa}

\item 
{\bfseries eta0\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a8a5b6805251ee054de00f35aa9917dde}{}\label{classdml_1_1mcml_1_1MCML_a8a5b6805251ee054de00f35aa9917dde}

\item 
{\bfseries learning\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a7830eb3bf60dd1698419307a765fcb6e}{}\label{classdml_1_1mcml_1_1MCML_a7830eb3bf60dd1698419307a765fcb6e}

\item 
{\bfseries adaptive\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a7bb39b6f8b31b3006c84c9a43bbe70ea}{}\label{classdml_1_1mcml_1_1MCML_a7bb39b6f8b31b3006c84c9a43bbe70ea}

\item 
{\bfseries method\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a38f3cbfba1e4de7dce453816f9b7ab62}{}\label{classdml_1_1mcml_1_1MCML_a38f3cbfba1e4de7dce453816f9b7ab62}

\item 
{\bfseries eps\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a3e47e84c124eac05a5f110968d22b621}{}\label{classdml_1_1mcml_1_1MCML_a3e47e84c124eac05a5f110968d22b621}

\item 
{\bfseries tol\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ab5064a7c7e7214b17015aed86775f8a9}{}\label{classdml_1_1mcml_1_1MCML_ab5064a7c7e7214b17015aed86775f8a9}

\item 
{\bfseries etamin\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ae4f8ac49bc3fe3a7f49b18c6f56cba6a}{}\label{classdml_1_1mcml_1_1MCML_ae4f8ac49bc3fe3a7f49b18c6f56cba6a}

\item 
{\bfseries l\+\_\+inc\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_aee3082de50ebefa808212a716346e760}{}\label{classdml_1_1mcml_1_1MCML_aee3082de50ebefa808212a716346e760}

\item 
{\bfseries l\+\_\+dec\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ab6510f4cb97eca6e4be9bad38c24a4fb}{}\label{classdml_1_1mcml_1_1MCML_ab6510f4cb97eca6e4be9bad38c24a4fb}

\item 
{\bfseries num\+\_\+its\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a00afb19f4afcc26aeb6e7367ef4564c4}{}\label{classdml_1_1mcml_1_1MCML_a00afb19f4afcc26aeb6e7367ef4564c4}

\item 
{\bfseries initial\+\_\+error\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a2243dbb87e3ba75ba0697f4d59bee713}{}\label{classdml_1_1mcml_1_1MCML_a2243dbb87e3ba75ba0697f4d59bee713}

\item 
{\bfseries final\+\_\+error\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_aa63de6f27a2ff66305e05ab96c5d4abd}{}\label{classdml_1_1mcml_1_1MCML_aa63de6f27a2ff66305e05ab96c5d4abd}

\item 
{\bfseries d\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a5cf1cb67a506cf18026feb7e8ed3ad0f}{}\label{classdml_1_1mcml_1_1MCML_a5cf1cb67a506cf18026feb7e8ed3ad0f}

\item 
{\bfseries nd\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a122dd4093562f818ccbeae30a6688641}{}\label{classdml_1_1mcml_1_1MCML_a122dd4093562f818ccbeae30a6688641}

\item 
{\bfseries X\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_ad8dfded232cd94061f0c9bc79f3ff853}{}\label{classdml_1_1mcml_1_1MCML_ad8dfded232cd94061f0c9bc79f3ff853}

\item 
{\bfseries y\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_acb9ba109473371b373773ec00b43f0e6}{}\label{classdml_1_1mcml_1_1MCML_acb9ba109473371b373773ec00b43f0e6}

\item 
{\bfseries M\+\_\+}\hypertarget{classdml_1_1mcml_1_1MCML_a783cb7d5548a0bff784d8309cbf6ac15}{}\label{classdml_1_1mcml_1_1MCML_a783cb7d5548a0bff784d8309cbf6ac15}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Maximally Collapsing Metric Learning (MCML)

A distance metric learning algorithm that learns minimizing the KL divergence to the maximally collapsing distribution.

Parameters
----------

num_dims : int, default=None.

    Number of dimensions for dimensionality reduction. Not supported yet.

learning_rate : string, default='adaptive'

    Type of learning rate update for gradient descent. Possible values are:

    - 'adaptive' : the learning rate will increase if the gradient step is succesful, else it will decrease.

    - 'constant' : the learning rate will be constant during all the gradient steps.

eta0 : float, default=0.01

    The initial value for learning rate.

initial_metric : 2D-Array or Matrix (d x d), or string, default=None.

    If array or matrix, it must be a positive semidefinite matrix with the starting metric for gradient descent, where d is the number of features.
    If None, euclidean distance will be used. If a string, the following values are allowed:

    - 'euclidean' : the euclidean distance.

    - 'scale' : a diagonal matrix that normalizes each attribute according to its range will be used.

max_iter : int, default=20

    Maximum number of iterations of gradient descent.

prec : float, default=1e-3

    Precision stop criterion (gradient norm).

tol : float, default=1e-3

    Tolerance stop criterion (difference between two iterations)

descent_method : string, default='SDP'

    The descent method to use. Allowed values are:

    - 'SDP' : semidefinite programming, consisting of gradient descent with projections onto the PSD cone.

eta_thres : float, default=1e-14

    A learning rate threshold stop criterion.

learn_inc : float, default=1.01

    Increase factor for learning rate. Ignored if learning_rate is not 'adaptive'.

learn_dec : float, default=0.5

    Decrease factor for learning rate. Ignored if learning_rate is not 'adaptive'.

References
----------
    Amir Globerson and Sam T Roweis. “Metric learning by collapsing classes”. In: Advances in neural
    information processing systems. 2006, pages 451-458.
\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\index{dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}!fit@{fit}}
\index{fit@{fit}!dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}}
\subsubsection[{\texorpdfstring{fit(self, X, y)}{fit(self, X, y)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+mcml.\+M\+C\+M\+L.\+fit (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{X, }
\item[{}]{y}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1mcml_1_1MCML_a0984330dd64aad712a46dcc3ba27baa8}{}\label{classdml_1_1mcml_1_1MCML_a0984330dd64aad712a46dcc3ba27baa8}
\begin{DoxyVerb}Fit the model from the data in X and the labels in y.

Parameters
----------
X : array-like, shape (N x d)
    Training vector, where N is the number of samples, and d is the number of features.

y : array-like, shape (N)
    Labels vector, where N is the number of samples.

Returns
-------
self : object
    Returns the instance itself.
\end{DoxyVerb}
 \index{dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}!metadata@{metadata}}
\index{metadata@{metadata}!dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}}
\subsubsection[{\texorpdfstring{metadata(self)}{metadata(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+mcml.\+M\+C\+M\+L.\+metadata (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1mcml_1_1MCML_a73bb7173d9688126b49e585ff4434892}{}\label{classdml_1_1mcml_1_1MCML_a73bb7173d9688126b49e585ff4434892}
\begin{DoxyVerb}Obtains algorithm metadata.

Returns
-------
meta : A dictionary with the following metadata:
    - 'num_iters' : Number of iterations that the descent method took.

    - 'initial_error' : Initial value of the objective function.

    - 'final_error' : Final value of the objective function.
\end{DoxyVerb}
 \index{dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}!metric@{metric}}
\index{metric@{metric}!dml\+::mcml\+::\+M\+C\+ML@{dml\+::mcml\+::\+M\+C\+ML}}
\subsubsection[{\texorpdfstring{metric(self)}{metric(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+mcml.\+M\+C\+M\+L.\+metric (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1mcml_1_1MCML_ad1980c9bf7c3b8843d36f8f1666e08a6}{}\label{classdml_1_1mcml_1_1MCML_ad1980c9bf7c3b8843d36f8f1666e08a6}
\begin{DoxyVerb}Obtains the learned metric.

Returns
-------
M : (dxd) positive semidefinite matrix, where d is the number of features.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
dml/mcml.\+pyx\end{DoxyCompactItemize}
