\hypertarget{classdml_1_1nca_1_1NCA}{}\section{dml.\+nca.\+N\+CA Class Reference}
\label{classdml_1_1nca_1_1NCA}\index{dml.\+nca.\+N\+CA@{dml.\+nca.\+N\+CA}}


Inheritance diagram for dml.\+nca.\+N\+CA\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=164pt]{classdml_1_1nca_1_1NCA__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for dml.\+nca.\+N\+CA\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=164pt]{classdml_1_1nca_1_1NCA__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+dims=None, learning\+\_\+rate=\char`\"{}adaptive\char`\"{}, eta0=0.\+3, initial\+\_\+transform=None, max\+\_\+iter=100, prec=1e-\/8, tol=1e-\/8, descent\+\_\+method=\char`\"{}\+S\+G\+D\char`\"{}, eta\+\_\+thres=1e-\/14, learn\+\_\+inc=1.\+01, learn\+\_\+dec=0.\+5)\hypertarget{classdml_1_1nca_1_1NCA_a86bb8dcbd925eb0be6479ab0e0d3fb22}{}\label{classdml_1_1nca_1_1NCA_a86bb8dcbd925eb0be6479ab0e0d3fb22}

\item 
def \hyperlink{classdml_1_1nca_1_1NCA_adb91f357b09c4c4188c6425a537b9330}{metadata} (self)
\item 
def \hyperlink{classdml_1_1nca_1_1NCA_a5d302fa9ea28b6857f3f9b2b7efb7c99}{transformer} (self)
\item 
def \hyperlink{classdml_1_1nca_1_1NCA_af8a6f753d4d4cc1b49d6dfdb8b44d73a}{fit} (self, X, y)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries num\+\_\+dims\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_aae858f8447f17e1b9b2358084ba210ed}{}\label{classdml_1_1nca_1_1NCA_aae858f8447f17e1b9b2358084ba210ed}

\item 
{\bfseries L0\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a01876307676c03a085fac3759aadaccc}{}\label{classdml_1_1nca_1_1NCA_a01876307676c03a085fac3759aadaccc}

\item 
{\bfseries max\+\_\+it\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a19accf1175911523f947f66865fdc79c}{}\label{classdml_1_1nca_1_1NCA_a19accf1175911523f947f66865fdc79c}

\item 
{\bfseries eta\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_ad005ff4569cf5db0bcb55349adf8dc55}{}\label{classdml_1_1nca_1_1NCA_ad005ff4569cf5db0bcb55349adf8dc55}

\item 
{\bfseries eta0\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_af8f01006660da5d2e1e485163c21bd79}{}\label{classdml_1_1nca_1_1NCA_af8f01006660da5d2e1e485163c21bd79}

\item 
{\bfseries learning\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_af60d4fcb14a2703e266354034e96f7f0}{}\label{classdml_1_1nca_1_1NCA_af60d4fcb14a2703e266354034e96f7f0}

\item 
{\bfseries adaptive\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_aaa43fbc972c4ffcec4dc237337be38f0}{}\label{classdml_1_1nca_1_1NCA_aaa43fbc972c4ffcec4dc237337be38f0}

\item 
{\bfseries method\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_ad0113eb881f8529f05912c32a2f812a5}{}\label{classdml_1_1nca_1_1NCA_ad0113eb881f8529f05912c32a2f812a5}

\item 
{\bfseries eps\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a62371155e2dc181c86c2029baca9a79f}{}\label{classdml_1_1nca_1_1NCA_a62371155e2dc181c86c2029baca9a79f}

\item 
{\bfseries tol\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_aed6186e6e52a5a8ee5b9d702e81323e3}{}\label{classdml_1_1nca_1_1NCA_aed6186e6e52a5a8ee5b9d702e81323e3}

\item 
{\bfseries etamin\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_ab6bf53dc847d68bb3ade5a62ac9c9a2b}{}\label{classdml_1_1nca_1_1NCA_ab6bf53dc847d68bb3ade5a62ac9c9a2b}

\item 
{\bfseries l\+\_\+inc\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a48a1afdf5fa216d1920c9702220fbf44}{}\label{classdml_1_1nca_1_1NCA_a48a1afdf5fa216d1920c9702220fbf44}

\item 
{\bfseries l\+\_\+dec\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_ac9cb622f0a26c6287fb2c7c8f04211d5}{}\label{classdml_1_1nca_1_1NCA_ac9cb622f0a26c6287fb2c7c8f04211d5}

\item 
{\bfseries num\+\_\+its\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a82a4d8e96d969702b6502fc1a55e290d}{}\label{classdml_1_1nca_1_1NCA_a82a4d8e96d969702b6502fc1a55e290d}

\item 
{\bfseries initial\+\_\+softmax\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a59666362ce20353bd94d2458139b0698}{}\label{classdml_1_1nca_1_1NCA_a59666362ce20353bd94d2458139b0698}

\item 
{\bfseries final\+\_\+softmax\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_aa3c03274f76ee022048fc72380c2a375}{}\label{classdml_1_1nca_1_1NCA_aa3c03274f76ee022048fc72380c2a375}

\item 
{\bfseries d\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a930059b9f0a023df96d65663bc2cdaa1}{}\label{classdml_1_1nca_1_1NCA_a930059b9f0a023df96d65663bc2cdaa1}

\item 
{\bfseries nd\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_aec8aad31b2c340c395e6cf2a6ef4050b}{}\label{classdml_1_1nca_1_1NCA_aec8aad31b2c340c395e6cf2a6ef4050b}

\item 
{\bfseries L\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_adc8c407795b11915d6a8ed4131ce22d0}{}\label{classdml_1_1nca_1_1NCA_adc8c407795b11915d6a8ed4131ce22d0}

\item 
{\bfseries X\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_a92379ea16856823e168e45eafda2f9ef}{}\label{classdml_1_1nca_1_1NCA_a92379ea16856823e168e45eafda2f9ef}

\item 
{\bfseries y\+\_\+}\hypertarget{classdml_1_1nca_1_1NCA_adb49c3d9bfa0aafc6ed6c4ed7adcfe96}{}\label{classdml_1_1nca_1_1NCA_adb49c3d9bfa0aafc6ed6c4ed7adcfe96}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Neighborhood Component Analysis (NCA)

A distance metric learning algorithm that tries to minimize kNN expected error.

Parameters
----------

num_dims : int, default=None

    Desired value for dimensionality reduction. If None, the dimension of transformed data will be the same as the original.

learning_rate : string, default='adaptive'

    Type of learning rate update for gradient descent. Possible values are:

    - 'adaptive' : the learning rate will increase if the gradient step is succesful, else it will decrease.

    - 'constant' : the learning rate will be constant during all the gradient steps.

eta0 : int, default=0.3

    The initial value for learning rate.

initial_transform : 2D-Array or Matrix (d' x d), or string, default=None.

    If array or matrix that will represent the starting linear map for gradient descent, where d is the number of features,
    and d' is the dimension specified in num_dims.
    If None, euclidean distance will be used. If a string, the following values are allowed:

    - 'euclidean' : the euclidean distance.

    - 'scale' : a diagonal matrix that normalizes each attribute according to its range will be used.

max_iter : int, default=100

    Maximum number of gradient descent iterations.

prec : float, default=1e-8

    Precision stop criterion (gradient norm).

tol : float, default=1e-8

    Tolerance stop criterion (difference between two iterations)

descent_method : string, default='SGD'

    The descent method to use. Allowed values are:

    - 'SGD' : stochastic gradient descent.

    - 'BGD' : batch gradient descent.

eta_thres : float, default=1e-14

    A learning rate threshold stop criterion.

learn_inc : float, default=1.01

    Increase factor for learning rate. Ignored if learning_rate is not 'adaptive'.

learn_dec : float, default=0.5

    Decrease factor for learning rate. Ignored if learning_rate is not 'adaptive'.

References
----------
    Jacob Goldberger et al. “Neighbourhood components analysis”. In: Advances in neural
    information processing systems. 2005, pages 513-520.\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\index{dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}!fit@{fit}}
\index{fit@{fit}!dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}}
\subsubsection[{\texorpdfstring{fit(self, X, y)}{fit(self, X, y)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+nca.\+N\+C\+A.\+fit (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{X, }
\item[{}]{y}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1nca_1_1NCA_af8a6f753d4d4cc1b49d6dfdb8b44d73a}{}\label{classdml_1_1nca_1_1NCA_af8a6f753d4d4cc1b49d6dfdb8b44d73a}
\begin{DoxyVerb}Fit the model from the data in X and the labels in y.

Parameters
----------
X : array-like, shape (N x d)
    Training vector, where N is the number of samples, and d is the number of features.

y : array-like, shape (N)
    Labels vector, where N is the number of samples.

Returns
-------
self : object
    Returns the instance itself.
\end{DoxyVerb}
 \index{dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}!metadata@{metadata}}
\index{metadata@{metadata}!dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}}
\subsubsection[{\texorpdfstring{metadata(self)}{metadata(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+nca.\+N\+C\+A.\+metadata (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1nca_1_1NCA_adb91f357b09c4c4188c6425a537b9330}{}\label{classdml_1_1nca_1_1NCA_adb91f357b09c4c4188c6425a537b9330}
\begin{DoxyVerb}Obtains algorithm metadata.

Returns
-------
meta : A dictionary with the following metadata:
    - num_iters : Number of iterations that the descent method took.

    - initial_expectance : Initial value of the objective function (the expected LOO score)

    - final_expectance : Final value of the objective function (the expected LOO score)
\end{DoxyVerb}
 \index{dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}!transformer@{transformer}}
\index{transformer@{transformer}!dml\+::nca\+::\+N\+CA@{dml\+::nca\+::\+N\+CA}}
\subsubsection[{\texorpdfstring{transformer(self)}{transformer(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+nca.\+N\+C\+A.\+transformer (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1nca_1_1NCA_a5d302fa9ea28b6857f3f9b2b7efb7c99}{}\label{classdml_1_1nca_1_1NCA_a5d302fa9ea28b6857f3f9b2b7efb7c99}
\begin{DoxyVerb}Obtains the learned projection.

Returns
-------
L : (d'xd) matrix, where d' is the desired output dimension and d is the number of features.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
dml/nca.\+pyx\end{DoxyCompactItemize}
