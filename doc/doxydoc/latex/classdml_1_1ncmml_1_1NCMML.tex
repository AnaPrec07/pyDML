\hypertarget{classdml_1_1ncmml_1_1NCMML}{}\section{dml.\+ncmml.\+N\+C\+M\+ML Class Reference}
\label{classdml_1_1ncmml_1_1NCMML}\index{dml.\+ncmml.\+N\+C\+M\+ML@{dml.\+ncmml.\+N\+C\+M\+ML}}


Inheritance diagram for dml.\+ncmml.\+N\+C\+M\+ML\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{classdml_1_1ncmml_1_1NCMML__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for dml.\+ncmml.\+N\+C\+M\+ML\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{classdml_1_1ncmml_1_1NCMML__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+dims=None, learning\+\_\+rate=\char`\"{}adaptive\char`\"{}, eta0=0.\+3, initial\+\_\+transform=None, max\+\_\+iter=300, tol=1e-\/15, prec=1e-\/15, descent\+\_\+method=\char`\"{}\+S\+G\+D\char`\"{}, eta\+\_\+thres=1e-\/14, learn\+\_\+inc=1.\+01, learn\+\_\+dec=0.\+5)\hypertarget{classdml_1_1ncmml_1_1NCMML_ab8f65e9ec8d26077738d3773507c95af}{}\label{classdml_1_1ncmml_1_1NCMML_ab8f65e9ec8d26077738d3773507c95af}

\item 
def \hyperlink{classdml_1_1ncmml_1_1NCMML_a039f90483b5b4c964c937921f5c01abe}{metadata} (self)
\item 
def \hyperlink{classdml_1_1ncmml_1_1NCMML_aa2d6d578bc96c46689b8c185c3067df8}{transformer} (self)
\item 
def \hyperlink{classdml_1_1ncmml_1_1NCMML_a2c0c1cddd8eec63be977b3fb4866923a}{fit} (self, X, y)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries num\+\_\+dims\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a7a7b7e5b6f6e1c6137bc8c4f4966fe81}{}\label{classdml_1_1ncmml_1_1NCMML_a7a7b7e5b6f6e1c6137bc8c4f4966fe81}

\item 
{\bfseries L0\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_aba8b2eb89d0d99dda734f2b423cbf786}{}\label{classdml_1_1ncmml_1_1NCMML_aba8b2eb89d0d99dda734f2b423cbf786}

\item 
{\bfseries max\+\_\+it\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_aab51c46920445814d37b20d0e1d40b84}{}\label{classdml_1_1ncmml_1_1NCMML_aab51c46920445814d37b20d0e1d40b84}

\item 
{\bfseries eta\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a67709c04f6faf927b0f36fd3a8f47ae8}{}\label{classdml_1_1ncmml_1_1NCMML_a67709c04f6faf927b0f36fd3a8f47ae8}

\item 
{\bfseries eta0\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_aa1a66e3579a51d8d65cda3e3a55eb5f7}{}\label{classdml_1_1ncmml_1_1NCMML_aa1a66e3579a51d8d65cda3e3a55eb5f7}

\item 
{\bfseries learning\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a56c65f669d9f92dbc686061a7cf49d27}{}\label{classdml_1_1ncmml_1_1NCMML_a56c65f669d9f92dbc686061a7cf49d27}

\item 
{\bfseries adaptive\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a5338e43bd3edd2fb27bafe465843b4cb}{}\label{classdml_1_1ncmml_1_1NCMML_a5338e43bd3edd2fb27bafe465843b4cb}

\item 
{\bfseries method\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a53ade464e911bfd448bdcc831f8b9b62}{}\label{classdml_1_1ncmml_1_1NCMML_a53ade464e911bfd448bdcc831f8b9b62}

\item 
{\bfseries eps\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ad78723654662dc2cddff99f27439400b}{}\label{classdml_1_1ncmml_1_1NCMML_ad78723654662dc2cddff99f27439400b}

\item 
{\bfseries tol\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ad205f159e63da5a4e27e7193df0d97c0}{}\label{classdml_1_1ncmml_1_1NCMML_ad205f159e63da5a4e27e7193df0d97c0}

\item 
{\bfseries etamin\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a5b540c37775e7f957259a997e280b376}{}\label{classdml_1_1ncmml_1_1NCMML_a5b540c37775e7f957259a997e280b376}

\item 
{\bfseries l\+\_\+inc\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ad8f2d336393c35f8e6a60817372e54fa}{}\label{classdml_1_1ncmml_1_1NCMML_ad8f2d336393c35f8e6a60817372e54fa}

\item 
{\bfseries l\+\_\+dec\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a091cdec44d78c87cb3a82d226b2e9146}{}\label{classdml_1_1ncmml_1_1NCMML_a091cdec44d78c87cb3a82d226b2e9146}

\item 
{\bfseries num\+\_\+its\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_abfc452a41f73f17183331a4713c22302}{}\label{classdml_1_1ncmml_1_1NCMML_abfc452a41f73f17183331a4713c22302}

\item 
{\bfseries initial\+\_\+expectance\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ae424f09f9828d9c8e4fac9211b1a1586}{}\label{classdml_1_1ncmml_1_1NCMML_ae424f09f9828d9c8e4fac9211b1a1586}

\item 
{\bfseries final\+\_\+expectance\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ade93bd8d6bf766205d85b1e9bbb33079}{}\label{classdml_1_1ncmml_1_1NCMML_ade93bd8d6bf766205d85b1e9bbb33079}

\item 
{\bfseries d\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a12a3da3b328a1e3c19ac3f94b5198b31}{}\label{classdml_1_1ncmml_1_1NCMML_a12a3da3b328a1e3c19ac3f94b5198b31}

\item 
{\bfseries nd\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a5fe286a4ad41e61e6d2170646173e7c5}{}\label{classdml_1_1ncmml_1_1NCMML_a5fe286a4ad41e61e6d2170646173e7c5}

\item 
{\bfseries L\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_aaf28d14f62f533bf1aefe2221c3e9a80}{}\label{classdml_1_1ncmml_1_1NCMML_aaf28d14f62f533bf1aefe2221c3e9a80}

\item 
{\bfseries X\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_ad14e5ca754753b16242b6a1a3b0816a2}{}\label{classdml_1_1ncmml_1_1NCMML_ad14e5ca754753b16242b6a1a3b0816a2}

\item 
{\bfseries y\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a31fb1f0fd8032ec6c9b37ddd31aa1098}{}\label{classdml_1_1ncmml_1_1NCMML_a31fb1f0fd8032ec6c9b37ddd31aa1098}

\item 
{\bfseries centroids\+\_\+}\hypertarget{classdml_1_1ncmml_1_1NCMML_a54514205517c532362e6d40a5ba26e51}{}\label{classdml_1_1ncmml_1_1NCMML_a54514205517c532362e6d40a5ba26e51}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Nearest Class Mean Metric Learning (NCMML)

A distance metric learning algorithm to improve the nearest class mean classifier.

Parameters
----------

num_dims : int, default=None

    Desired value for dimensionality reduction. If None, the dimension of transformed data will be the same as the original.

learning_rate : string, default='adaptive'

    Type of learning rate update for gradient descent. Possible values are:

    - 'adaptive' : the learning rate will increase if the gradient step is succesful, else it will decrease.

    - 'constant' : the learning rate will be constant during all the gradient steps.

eta0 : int, default=0.3

    The initial value for learning rate.

initial_transform : 2D-Array or Matrix (d' x d), or string, default=None.

    If array or matrix that will represent the starting linear map for gradient descent, where d is the number of features,
    and d' is the dimension specified in num_dims.
    If None, euclidean distance will be used. If a string, the following values are allowed:

    - 'euclidean' : the euclidean distance.

    - 'scale' : a diagonal matrix that normalizes each attribute according to its range will be used.

max_iter : int, default=300

    Maximum number of gradient descent iterations.

prec : float, default=1e-15

    Precision stop criterion (gradient norm).

tol : float, default=1e-15

    Tolerance stop criterion (difference between two iterations)

descent_method : string, default='SGD'

    The descent method to use. Allowed values are:

    - 'SGD' : stochastic gradient descent.

    - 'BGD' : batch gradient descent.

eta_thres : float, default=1e-14

    A learning rate threshold stop criterion.

learn_inc : float, default=1.01

    Increase factor for learning rate. Ignored if learning_rate is not 'adaptive'.

learn_dec : float, default=0.5

    Decrease factor for learning rate. Ignored if learning_rate is not 'adaptive'.

References
----------
    Thomas Mensink et al. “Metric learning for large scale image classification: Generalizing to new
    classes at near-zero cost”. In: Computer Vision–ECCV 2012. Springer, 2012, pages 488-501.\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\index{dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}!fit@{fit}}
\index{fit@{fit}!dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}}
\subsubsection[{\texorpdfstring{fit(self, X, y)}{fit(self, X, y)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmml.\+N\+C\+M\+M\+L.\+fit (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{X, }
\item[{}]{y}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmml_1_1NCMML_a2c0c1cddd8eec63be977b3fb4866923a}{}\label{classdml_1_1ncmml_1_1NCMML_a2c0c1cddd8eec63be977b3fb4866923a}
\begin{DoxyVerb}Fit the model from the data in X and the labels in y.

Parameters
----------
X : array-like, shape (N x d)
    Training vector, where N is the number of samples, and d is the number of features.

y : array-like, shape (N)
    Labels vector, where N is the number of samples.

Returns
-------
self : object
    Returns the instance itself.
\end{DoxyVerb}
 \index{dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}!metadata@{metadata}}
\index{metadata@{metadata}!dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}}
\subsubsection[{\texorpdfstring{metadata(self)}{metadata(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmml.\+N\+C\+M\+M\+L.\+metadata (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmml_1_1NCMML_a039f90483b5b4c964c937921f5c01abe}{}\label{classdml_1_1ncmml_1_1NCMML_a039f90483b5b4c964c937921f5c01abe}
\begin{DoxyVerb}Obtains algorithm metadata.

Returns
-------
meta : A dictionary with the following metadata:
    - num_iters : Number of iterations that the descent method took.

    - initial_expectance : Initial value of the objective function (the expected score)

    - final_expectance : Final value of the objective function (the expected score)
\end{DoxyVerb}
 \index{dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}!transformer@{transformer}}
\index{transformer@{transformer}!dml\+::ncmml\+::\+N\+C\+M\+ML@{dml\+::ncmml\+::\+N\+C\+M\+ML}}
\subsubsection[{\texorpdfstring{transformer(self)}{transformer(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmml.\+N\+C\+M\+M\+L.\+transformer (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmml_1_1NCMML_aa2d6d578bc96c46689b8c185c3067df8}{}\label{classdml_1_1ncmml_1_1NCMML_aa2d6d578bc96c46689b8c185c3067df8}
\begin{DoxyVerb}Obtains algorithm metadata.

Returns
-------
meta : A dictionary with the following metadata:
    - num_iters : Number of iterations that the descent method took.

    - initial_expectance : Initial value of the objective function (the expected score)

    - final_expectance : Final value of the objective function (the expected score)
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
dml/ncmml.\+pyx\end{DoxyCompactItemize}
