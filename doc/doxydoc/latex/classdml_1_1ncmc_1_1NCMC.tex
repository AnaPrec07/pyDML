\hypertarget{classdml_1_1ncmc_1_1NCMC}{}\section{dml.\+ncmc.\+N\+C\+MC Class Reference}
\label{classdml_1_1ncmc_1_1NCMC}\index{dml.\+ncmc.\+N\+C\+MC@{dml.\+ncmc.\+N\+C\+MC}}


Inheritance diagram for dml.\+ncmc.\+N\+C\+MC\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=173pt]{classdml_1_1ncmc_1_1NCMC__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for dml.\+ncmc.\+N\+C\+MC\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=173pt]{classdml_1_1ncmc_1_1NCMC__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+dims=None, centroids\+\_\+num=3, learning\+\_\+rate=\char`\"{}adaptive\char`\"{}, eta0=0.\+3, initial\+\_\+transform=None, max\+\_\+iter=300, tol=1e-\/15, prec=1e-\/15, descent\+\_\+method=\char`\"{}\+S\+G\+D\char`\"{}, eta\+\_\+thres=1e-\/14, learn\+\_\+inc=1.\+01, learn\+\_\+dec=0.\+5, kmeans\+\_\+kwargs)\hypertarget{classdml_1_1ncmc_1_1NCMC_a905f1d40b974485150080efa24733d5e}{}\label{classdml_1_1ncmc_1_1NCMC_a905f1d40b974485150080efa24733d5e}

\item 
def \hyperlink{classdml_1_1ncmc_1_1NCMC_a4d5a73df974b062e4f4d2f541e473a25}{metadata} (self)
\item 
def \hyperlink{classdml_1_1ncmc_1_1NCMC_a2744b247a6e0afba68ffe9ed51da5ad5}{transformer} (self)
\item 
def \hyperlink{classdml_1_1ncmc_1_1NCMC_a628e2c403fff6e06d8c7fcc24dd23440}{fit} (self, X, y)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries num\+\_\+dims\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a67faede3a06694e52a0a352085163baa}{}\label{classdml_1_1ncmc_1_1NCMC_a67faede3a06694e52a0a352085163baa}

\item 
{\bfseries L0\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a242497eba5bc9fe6323115a48b9248cc}{}\label{classdml_1_1ncmc_1_1NCMC_a242497eba5bc9fe6323115a48b9248cc}

\item 
{\bfseries max\+\_\+it\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a74c4ae0e92c8e695264b37f69b3d730a}{}\label{classdml_1_1ncmc_1_1NCMC_a74c4ae0e92c8e695264b37f69b3d730a}

\item 
{\bfseries eta\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_aa1b6c1b93ca9f0aa01d6647fa76e08e8}{}\label{classdml_1_1ncmc_1_1NCMC_aa1b6c1b93ca9f0aa01d6647fa76e08e8}

\item 
{\bfseries eta0\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a1ab8a06bc261d1b77e591c204fd92fd7}{}\label{classdml_1_1ncmc_1_1NCMC_a1ab8a06bc261d1b77e591c204fd92fd7}

\item 
{\bfseries learning\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_abddf783ace039f357afba48b7fdaaf2a}{}\label{classdml_1_1ncmc_1_1NCMC_abddf783ace039f357afba48b7fdaaf2a}

\item 
{\bfseries adaptive\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a5b8c46121373cb076fdd8b2a2dffa773}{}\label{classdml_1_1ncmc_1_1NCMC_a5b8c46121373cb076fdd8b2a2dffa773}

\item 
{\bfseries method\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a294c3834e2889d54994baf40b7662a94}{}\label{classdml_1_1ncmc_1_1NCMC_a294c3834e2889d54994baf40b7662a94}

\item 
{\bfseries eps\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_acb4c399bc8771bddaa70c736809cc4d5}{}\label{classdml_1_1ncmc_1_1NCMC_acb4c399bc8771bddaa70c736809cc4d5}

\item 
{\bfseries tol\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a61d1495b8e2f4c064ebd7e0ef1e76686}{}\label{classdml_1_1ncmc_1_1NCMC_a61d1495b8e2f4c064ebd7e0ef1e76686}

\item 
{\bfseries etamin\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a40eb9f1a59eba0790c7090fe812717c4}{}\label{classdml_1_1ncmc_1_1NCMC_a40eb9f1a59eba0790c7090fe812717c4}

\item 
{\bfseries l\+\_\+inc\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_ad9a6fb3682a18eac720f9325fec3c43a}{}\label{classdml_1_1ncmc_1_1NCMC_ad9a6fb3682a18eac720f9325fec3c43a}

\item 
{\bfseries l\+\_\+dec\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a04d0bf48715cd0627616248e4c27393d}{}\label{classdml_1_1ncmc_1_1NCMC_a04d0bf48715cd0627616248e4c27393d}

\item 
{\bfseries centroids\+\_\+num\+\_\+init\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_ae313d6fa6deecbbb22dad07ba136d3f8}{}\label{classdml_1_1ncmc_1_1NCMC_ae313d6fa6deecbbb22dad07ba136d3f8}

\item 
{\bfseries kmeans\+\_\+kwargs\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a075d2a9fb68da758606b55a4b6a5bcc9}{}\label{classdml_1_1ncmc_1_1NCMC_a075d2a9fb68da758606b55a4b6a5bcc9}

\item 
{\bfseries num\+\_\+its\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a0bf55f870c9abde05ac30291df43b4f3}{}\label{classdml_1_1ncmc_1_1NCMC_a0bf55f870c9abde05ac30291df43b4f3}

\item 
{\bfseries initial\+\_\+expectance\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a990e271c53c0245ae6df6c8c1d7be8c6}{}\label{classdml_1_1ncmc_1_1NCMC_a990e271c53c0245ae6df6c8c1d7be8c6}

\item 
{\bfseries final\+\_\+expectance\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_af3c9d6b2ea5d5f1bbe93257e130a7edb}{}\label{classdml_1_1ncmc_1_1NCMC_af3c9d6b2ea5d5f1bbe93257e130a7edb}

\item 
{\bfseries d\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_af91ddd5d84ae4ae854d59af57f81131e}{}\label{classdml_1_1ncmc_1_1NCMC_af91ddd5d84ae4ae854d59af57f81131e}

\item 
{\bfseries nd\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_ac2c635c38bd02a30dadb01ab750a86c6}{}\label{classdml_1_1ncmc_1_1NCMC_ac2c635c38bd02a30dadb01ab750a86c6}

\item 
{\bfseries L\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_ac1113fea1d4cb668f4267ae17ef8090a}{}\label{classdml_1_1ncmc_1_1NCMC_ac1113fea1d4cb668f4267ae17ef8090a}

\item 
{\bfseries X\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_abbaf2c9a61c10c46865fa00481902a54}{}\label{classdml_1_1ncmc_1_1NCMC_abbaf2c9a61c10c46865fa00481902a54}

\item 
{\bfseries y\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a08dc4ef78d2edb19c4ad1c35fcb85b6e}{}\label{classdml_1_1ncmc_1_1NCMC_a08dc4ef78d2edb19c4ad1c35fcb85b6e}

\item 
{\bfseries centroids\+\_\+num\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_a0b6f1372cbc347c37924336f61c34aa7}{}\label{classdml_1_1ncmc_1_1NCMC_a0b6f1372cbc347c37924336f61c34aa7}

\item 
{\bfseries cs\+\_\+}\hypertarget{classdml_1_1ncmc_1_1NCMC_addc68abedb2aac2c113156054143a552}{}\label{classdml_1_1ncmc_1_1NCMC_addc68abedb2aac2c113156054143a552}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Nearest Class with Multiple Centroids distance metric learner (NCMC).

A distance metric learning algorithm to improve the nearest class with multiple centroids classifier.

Parameters
----------

num_dims : int, default=None

    Desired value for dimensionality reduction. If None, the dimension of transformed data will be the same as the original.

centroids_num : int, or list of int, default=3

    If it is a list, it must have the same size as the number of classes. In this case, i-th item will be the number of
    centroids to take in the i-th class. If it is an int, every class will have the same number of centroids.

learning_rate : string, default='adaptive'

    Type of learning rate update for gradient descent. Possible values are:

    - 'adaptive' : the learning rate will increase if the gradient step is succesful, else it will decrease.

    - 'constant' : the learning rate will be constant during all the gradient steps.

eta0 : int, default=0.3

    The initial value for learning rate.

initial_transform : 2D-Array or Matrix (d' x d), or string, default=None.

    If array or matrix that will represent the starting linear map for gradient descent, where d is the number of features,
    and d' is the dimension specified in num_dims.
    If None, euclidean distance will be used. If a string, the following values are allowed:

    - 'euclidean' : the euclidean distance.

    - 'scale' : a diagonal matrix that normalizes each attribute according to its range will be used.

max_iter : int, default=300

    Maximum number of gradient descent iterations.

prec : float, default=1e-15

    Precision stop criterion (gradient norm).

tol : float, default=1e-15

    Tolerance stop criterion (difference between two iterations)

descent_method : string, default='SGD'

    The descent method to use. Allowed values are:

    - 'SGD' : stochastic gradient descent.

    - 'BGD' : batch gradient descent.

eta_thres : float, default=1e-14

    A learning rate threshold stop criterion.

learn_inc : float, default=1.01

    Increase factor for learning rate. Ignored if learning_rate is not 'adaptive'.

learn_dec : float, default=0.5

    Decrease factor for learning rate. Ignored if learning_rate is not 'adaptive'.

References
----------
    Thomas Mensink et al. “Metric learning for large scale image classification: Generalizing to new
    classes at near-zero cost”. In: Computer Vision–ECCV 2012. Springer, 2012, pages 488-501.\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\index{dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}!fit@{fit}}
\index{fit@{fit}!dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}}
\subsubsection[{\texorpdfstring{fit(self, X, y)}{fit(self, X, y)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmc.\+N\+C\+M\+C.\+fit (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{X, }
\item[{}]{y}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmc_1_1NCMC_a628e2c403fff6e06d8c7fcc24dd23440}{}\label{classdml_1_1ncmc_1_1NCMC_a628e2c403fff6e06d8c7fcc24dd23440}
\begin{DoxyVerb}Fit the model from the data in X and the labels in y.

Parameters
----------
X : array-like, shape (N x d)
    Training vector, where N is the number of samples, and d is the number of features.

y : array-like, shape (N)
    Labels vector, where N is the number of samples.

Returns
-------
self : object
    Returns the instance itself.
\end{DoxyVerb}
 \index{dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}!metadata@{metadata}}
\index{metadata@{metadata}!dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}}
\subsubsection[{\texorpdfstring{metadata(self)}{metadata(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmc.\+N\+C\+M\+C.\+metadata (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmc_1_1NCMC_a4d5a73df974b062e4f4d2f541e473a25}{}\label{classdml_1_1ncmc_1_1NCMC_a4d5a73df974b062e4f4d2f541e473a25}
\begin{DoxyVerb}Obtains algorithm metadata.

Returns
-------
meta : A dictionary with the following metadata:
    - num_iters : Number of iterations that the descent method took.

    - initial_expectance : Initial value of the objective function (the expected score)

    - final_expectance : Final value of the objective function (the expected score)
\end{DoxyVerb}
 \index{dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}!transformer@{transformer}}
\index{transformer@{transformer}!dml\+::ncmc\+::\+N\+C\+MC@{dml\+::ncmc\+::\+N\+C\+MC}}
\subsubsection[{\texorpdfstring{transformer(self)}{transformer(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def dml.\+ncmc.\+N\+C\+M\+C.\+transformer (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classdml_1_1ncmc_1_1NCMC_a2744b247a6e0afba68ffe9ed51da5ad5}{}\label{classdml_1_1ncmc_1_1NCMC_a2744b247a6e0afba68ffe9ed51da5ad5}
\begin{DoxyVerb}Obtains the learned projection.

Returns
-------
L : (d'xd) matrix, where d' is the desired output dimension and d is the number of features.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
dml/ncmc.\+pyx\end{DoxyCompactItemize}
